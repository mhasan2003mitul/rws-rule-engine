package nl.rws.re.rules.dakkapel;
import nl.rws.re.facts.dakkapelx.Grondslag;
import nl.rws.re.facts.dakkapelx.GrondslagBeschrijving;
import nl.rws.re.facts.dakkapelx.GebruikerVragen;
import nl.rws.re.facts.dakkapelx.Vraag;
import nl.rws.re.facts.dakkapelx.VraagBuilder;
import nl.rws.re.facts.dakkapelx.Antwoord;
import nl.rws.re.facts.dakkapelx.RuleResultaat;
import nl.rws.re.facts.dakkapelx.RuleResultaat.ResultaatVoor;

import nl.rws.re.facts.dakkapelx.Error;
import nl.rws.re.facts.dakkapelx.ErrorMessage;

import java.util.List;
import java.util.Arrays
import java.util.ArrayList;

dialect  "mvel"

declare VraagFromGrondslagDeel
end

rule "Is 'Dakpannen rondom' grondslag beslissing ontbekend?"
    when
        $grondslagRondom: Grondslag(grondslagBeschrijving == GrondslagBeschrijving.DAKPANNEN_RONDOM.toString(), definitieveBeslissing==null)
    then
        retract($grondslagRondom);
        Vraag vraag = new Vraag();
        vraag.setVraagId("1");
        insert(vraag);
        insert(new VraagFromGrondslagDeel());
end

rule "Is 'Op een schuin dak' grondslag beslissing ontbekend?"
    when
        $grondslagRondom: Grondslag(grondslagBeschrijving == GrondslagBeschrijving.OP_EEN_SCHUIN_DAK.toString(), definitieveBeslissing==null)
    then
        retract($grondslagRondom);
        Vraag vraag = new Vraag();
        vraag.setVraagId("2");
        insert(vraag);
        insert(new VraagFromGrondslagDeel());
end

rule "Rule voor JA beslissing voor definitie"
    when
        $rondomVraag:Vraag(vraagId=="1",antwoord == Antwoord.JA.name())
        $schuinVraag:Vraag(vraagId=="2",antwoord == Antwoord.JA.name())
    then
        retract($rondomVraag);
        retract($schuinVraag);
        insert(new RuleResultaat(ResultaatVoor.DEFINITIE.name(),Antwoord.JA.name()));
end

rule "Rule voor Nee beslissing voor definitie"
    when
        not(VraagFromGrondslagDeel())
        $rondomVraag:Vraag(vraagId=="1",antwoord!=null)
        $schuinVraag:Vraag(vraagId=="2",antwoord!=null)
        (Vraag(vraagId == "1", antwoord != Antwoord.JA.name()) or
        Vraag(vraagId == "2", antwoord != Antwoord.JA.name()))
    then
        retract($rondomVraag);
        retract($schuinVraag);
        insert(new RuleResultaat(ResultaatVoor.DEFINITIE.name(),Antwoord.NEE.name()));
end
